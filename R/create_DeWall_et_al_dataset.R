# ----------------------------------------------------------------------------
# file: create_DeWall_et_al_dataset.R
# author: Jason Grafmiller
# date: 2025-01-22
# description:
# Code for creating a dataset from tables 1-5 reported in 
# DeWall, et al. (2011) Tuning in to psychological change: Linguistic markers 
# of psychological traits and emotions over time in popular U.S. song lyrics. 
# Psychology of Aesthetics, Creativity, and the Arts, 5 (3): 200â€“207. 
# doi:10.1037/a0023195.
# ----------------------------------------------------------------------------

library(here)
library(tidyverse)

# Get data ----------------------------------------------------------------

# Copy and clean the numbers from the tables in the pdf. I simply copied and 
# pasted the text of each table into R, then do some cleaning and formatting.

# Table 1: 1P singular
t <- "1980 6.88 (5.95) (2.62, 11.14) 1981 9.39 (7.26) (4.19, 14.58) 1982 8.62 (5.19) (4.90, 12.33) 1983 5.92 (4.33) (2.82, 9.01) 1984 7.51 (3.35) (5.12, 9.91) 1985 9.70 (5.85) (5.52, 13.89) 1986 8.46 (6.54) (3.78, 13.13) 1987 6.40 (6.75) (1.57, 11.23) 1988 8.92 (3.82) (6.19, 11.66) 1989 11.04 (5.18) (7.33, 14.75) 1990 6.59 (4.98) (3.02, 10.15) 1991 10.28 (3.34) (7.89, 12.67) 1992 9.63 (4.93) (6.10, 13.15) 1993 10.78 (4.40) (7.63, 13.92) 1994 12.83 (5.19) (9.11, 16.54) 1995 8.69 (5.11) (5.03, 12.34) 1996 10.23 (5.97) (5.98, 14.52) 1997 12.49 (5.09) (8.85, 16.13) 1998 9.61 (5.52) (5.66, 13.55) 1999 8.68 (3.92) (5.88, 11.48) 2000 8.88 (5.87) (4.68, 13.08) 2001 12.50 (4.50) (9.28, 15.71) 2002 10.38 (4.61) (7.09, 13.68) 2003 13.03 (6.04) (8.71, 17.35) 2004 8.72 (3.04) (6.55, 10.90) 2005 9.50 (3.51) (6.99, 12.01) 2006 7.35 (3.55) (4.81, 9.89) 2007 9.18 (2.11) (7.67, 10.69)"

df_1ps <- str_replace_all(t, "(\\)|I) (1|2)", "\\1\n\\2") |> # add newlines
  str_split("\n") |> # split by newline and unlist
  unlist() |> 
  str_remove_all("[\\(\\),]") |> # remove all brackets and commas
  str_replace_all("\\s+", " ") |> # remove extra spaces
  str_replace_all(" \\.", " 0.") |> # add 0s before decimal points
  map(~ str_split(.x, "\\s", simplify = T) |> # loop over each line, split by spaces and coerce into data.frame 
        as.data.frame()) |> 
  bind_rows() |> # bind into single big data.frame
  setNames(c("Year", "Mean", "SD", "lower_ci", "upper_ci")) |> # set the column names 
  mutate(Feature = "1P sing pronoun") # add a column for the feature being measured

# Table 2: 1P plural
t <- "1980 1.11 (1.45) (.07, 2.14) 1981 2.07 (3.70) ( .57, 4.72) 1982 2.38 (2.53) (.56, 4.19) 1983 .21 (.53) ( 17, .60) 1984 .49 (.66) (.02, .96) 1985 1.44 (1.52) (.35, 2.53) 1986 1.56 (1.66) (.37, 2.74) 1987 1.16 (2.16) ( .37, 2.71) 1988 1.23 (1.21) (.36, 2.09) 1989 .68 (.95) ( .005, 1.36) 1990 .19 (.31) ( .03, .41) 1991 1.65 (1.96) (.24, 3.05) 1992 .76 (.81) (.17, 1.34) 1993 .47 (.63) (.02, .93) 1994 .58 (.75) (.04, 1.18) 1995 1.43 (3.02) ( .74, 3.59) 1996 .72 (1.19) ( .13, 1.57) 1997 .84 (.88) (.20, 1.47) 1998 .99 (1.55) ( .12, 2.09) 1999 .62 (.57) (.21, 1.03) 2000 1.05 (2.12) ( .46, 2.57) 2001 .47 (.64) (.01, .93) 2002 .50 (.53) (.12, .88) 2003 .81 (1.61) ( .34, 1.97) 2004 .74 (1.13) ( .07, 1.54) 2005 1.08 (1.15) (.25, 1.90) 2006 .69 (.58) (.27, 1.10) 2007 1.30 (1.25) (.40, 2.20)"

df_1ppl <- str_replace_all(t, "(\\)|I) (1|2)", "\\1\n\\2") |> 
  str_split("\n") |> 
  unlist() |> 
  str_remove_all("[\\(\\),]") |> 
  str_replace_all("\\s+", " ") |> 
  str_replace_all(" \\.", " 0.") |> 
  map(~ str_split(.x, "\\s", simplify = T) |> 
        as.data.frame()) |> 
  bind_rows() |> 
  setNames(c("Year", "Mean", "SD", "lower_ci", "upper_ci")) |> 
  mutate(Feature = "1P plural pronoun") 

# Table 3: social indicators
t <- "1980 15.17 (4.66) (11.84, 18.50) 1981 19.57 (5.48) (15.65, 23.49) 1982 14.64 (5.60) (10.64, 18.64) 1983 17.03 (6.46) (12.41, 21.65) 1984 15.70 (5.31) (11.90, 19.50) 1985 12.81 (3.44) (10.35, 15.27) 1986 14.94 (8.24) (9.05, 20.84) 1987 14.38 (5.54) (10.42, 18.34) 1988 14.08 (4.56) (10.82, 17.34) 1989 18.46 (6.37) (13.89, 23.00) 1990 13.92 (4.95) (10.38, 17.47) 1991 18.01 (3.96) (15.17, 20.84) 1992 14.81 (3.74) (12.14, 17.49) 1993 16.68 (4.40) (13.53, 19.83) 1994 12.83 (5.35) (9.00, 16.66) 1995 16.20 (4.49) (12.98, 19.41) 1996 17.82 (5.30) (14.03, 21.61) 1997 12.11 (4.58) (8.83, 15.39) 1998 15.16 (6.20) (10.73, 19.60) 1999 13.70 (4.79) (10.28, 17.13) 2000 15.82 (4.92) (12.29, 19.34) 2001 12.52 (5.32) (8.72, 16.33) 2002 14.09 (6.30) (9.58, 18.60) 2003 13.13 (4.19) (10.13, 16.13) 2004 14.02 (4.20) (11.01, 17.03) 2005 14.69 (7.74) (9.15, 20.23) 2006 14.20 (3.18) (11.93, 16.47) 2007 13.76 (3.46) (11.28, 16.23)"

df_social <- str_replace_all(t, "(\\)|I) (1|2)", "\\1\n\\2") |> 
  str_split("\n") |> 
  unlist() |> 
  str_remove_all("[\\(\\),]") |> 
  str_replace_all("\\s+", " ") |> 
  str_replace_all(" \\.", " 0.") |> 
  map(~ str_split(.x, "\\s", simplify = T) |> 
        as.data.frame()) |> 
  bind_rows() |> 
  setNames(c("Year", "Mean", "SD", "lower_ci", "upper_ci")) |> 
  mutate(Feature = "social indicators") 

# Table 4: positive affect indicators
t <- "1980 4.11 (3.25) (1.78, 6.44) 1981 7.42 (3.66) (4.80, 10.04) 1982 3.91 (2.31) (2.26, 5.56) 1983 3.18 (1.17) (2.34, 4.02) 1984 3.85 (1.31) (2.91, 4.79) 1985 4.08 (1.71) (2.86, 5.30) 1986 6.12 (4.40) (2.97, 9.27) 1987 2.60 (1.65) (1.42, 3.78) 1988 5.23 (3.16) (2.97, 7.49) 1989 6.60 (3.49) (4.10, 9.10) 1990 5.26 (3.68) (2.63, 7.89) 1991 6.04 (5.64) (2.00, 10.07) 1992 5.00 (3.02) (2.84, 7.16) 1993 6.51 (4.23) (3.48, 9.53) 1994 4.45 (2.14) (2.92, 5.98) 1995 5.57 (3.42) (3.12, 8.01) 1996 5.06 (3.21) (2.77, 7.36) 1997 4.64 (2.57) (2.81, 6.48) 1998 5.34 (3.63) (2.74, 7.94) 1999 3.33 (2.22) (1.74, 4.92) 2000 3.32 (2.16) (1.77, 4.86) 2001 3.63 (2.96) (1.51, 5.75) 2002 2.23 (1.22) (1.36, 3.11) 2003 3.61 (2.17) (2.06, 5.16) 2004 3.63 (2.62) (1.76, 5.50) 2005 2.89 (1.91) (1.52, 4.25) 2006 3.37 (3.10) (1.15, 5.59) 2007 3.48 (2.41) (1.75, 5.20)"

df_positive <- str_replace_all(t, "(\\)|I) (1|2)", "\\1\n\\2") |> 
  str_split("\n") |> 
  unlist() |> 
  str_remove_all("[\\(\\),]") |> 
  str_replace_all("\\s+", " ") |> 
  str_replace_all(" \\.", " 0.") |> 
  map(~ str_split(.x, "\\s", simplify = T) |> 
        as.data.frame()) |> 
  bind_rows() |> 
  setNames(c("Year", "Mean", "SD", "lower_ci", "upper_ci")) |> 
  mutate(Feature = "positive affect") 

# Table 5: antisocial indicators
t <- "1980 .27 (.50) ( .08, .63) 1981 .25 (.56) ( .15, .64) 1982 .18 (.58) ( 23, .59) 1983 1.13 (2.04) ( .33, 2.59) 1984 .40 (.94) ( .27, 1.07) 1985 .30 (.59) ( .12, .72) 1986 .46 (.90) ( .18, 1.11) 1987 .10 (.22) ( .05, .26) 1988 .07 (.22) ( .09, .23) 1989 .45 (.60) (.02, .88) 1990 .99 (1.81) ( .30, 2.28) 1991 1.15 (2.97) ( .98, 3.27) 1992 .42 (.92) ( .24, 1.08) 1993 .58 (1.02) ( .15, 1.31) 1994 .24 (.40) ( .04, .53) 1995 .28 (.34) (.04, .52) 1996 .60 (1.68) ( .60, 1.81) 1997 .32 (.44) (.006, .63) 1998 .57 (.81) ( .008, 1.15) 1999 .78 (.94) (.11, 1.45) 2000 .62 (1.40) ( .38, 1.62) 2001 1.62 (2.20) (.04, 3.19) 2002 .61 (.55) (.22, 1.01) 2003 1.29 (1.88) ( .05, 2.64) 2004 1.08 (1.89) ( .27, 2.43) 2005 1.82 (2.70) ( .12, 3.75) 2006 .84 (.96) (.15, 1.52) 2007 .80 (1.12) (.004, 1.60)"

df_antisocial <- str_replace_all(t, "(\\)|I) (1|2)", "\\1\n\\2") |> 
  str_split("\n") |> 
  unlist() |> 
  str_remove_all("[\\(\\),]") |> 
  str_replace_all("\\s+", " ") |> 
  str_replace_all(" \\.", " 0.") |> 
  map(~ str_split(.x, "\\s", simplify = T) |> 
        as.data.frame()) |> 
  bind_rows() |> 
  setNames(c("Year", "Mean", "SD", "lower_ci", "upper_ci")) |> 
  mutate(Feature = "anti-social indicators") 


# Save data ---------------------------------------------------------------

bind_rows(df_1ps, df_1ppl, df_social, df_positive, df_antisocial) |> 
  write_csv(here("data", "DeWall_et_al_2011_dataset.csv"))



















